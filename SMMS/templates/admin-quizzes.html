{% extends "base.html" %}
{% load static %}
{% block title %}Admin Programs{% endblock %}
{% block content %}
<style>
        /* Additional styles specific to quizzes page */
        .quiz-type-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }
        
        .quiz-type-weekly {
            background-color: var(--primary-blue-lighter);
            color: var(--primary-blue);
        }
        
        .quiz-type-module {
            background-color: var(--success-light);
            color: var(--success-color);
        }
        
        .quiz-type-assessment {
            background-color: var(--warning-light);
            color: var(--warning-color);
        }
        
        .quiz-type-final {
            background-color: var(--danger-light);
            color: var(--danger-color);
        }
        
        .difficulty-level {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .difficulty-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--border-light);
        }
        
        .difficulty-dot.active {
            background-color: var(--primary-blue);
        }
        
        .difficulty-easy .difficulty-dot:nth-child(1) {
            background-color: var(--success-color);
        }
        
        .difficulty-medium .difficulty-dot:nth-child(1),
        .difficulty-medium .difficulty-dot:nth-child(2) {
            background-color: var(--warning-color);
        }
        
        .difficulty-hard .difficulty-dot:nth-child(1),
        .difficulty-hard .difficulty-dot:nth-child(2),
        .difficulty-hard .difficulty-dot:nth-child(3) {
            background-color: var(--danger-color);
        }
        
        .progress-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .progress-bar {
            flex: 1;
            height: 6px;
            background-color: var(--bg-light);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--success-color);
        }
        
        .progress-text {
            font-size: 12px;
            color: var(--text-dark);
            font-weight: 500;
            width: 45px;
            text-align: right;
        }
        
        .quiz-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--bg-white);
            border-radius: var(--border-radius);
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--box-shadow-lg);
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            font-size: 18px;
            margin: 0;
            color: var(--dark-blue);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--text-muted);
            transition: var(--transition);
        }
        
        .modal-close:hover {
            color: var(--danger-color);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .quiz-info {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-light);
        }
        
        .quiz-info-item {
            display: flex;
            margin-bottom: 10px;
        }
        
        .quiz-info-label {
            width: 150px;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .quiz-info-value {
            flex: 1;
            color: var(--text-medium);
        }
        
        .question-list {
            counter-reset: question-counter;
        }
        
        .question-item {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-light);
        }
        
        .question-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .question-text {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 15px;
            counter-increment: question-counter;
        }
        
        .question-text::before {
            content: "Q" counter(question-counter) ". ";
            color: var(--primary-blue);
        }
        
        .options-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .option-item {
            padding: 10px 15px;
            border: 1px solid var(--border-light);
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }
        
        .option-item:hover {
            background-color: var(--bg-light);
        }
        
        .option-item:last-child {
            margin-bottom: 0;
        }
        
        .option-marker {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--border-medium);
            margin-right: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .option-text {
            flex: 1;
        }
        
        .option-item.correct {
            background-color: var(--success-light);
            border-color: var(--success-color);
        }
        
        .option-item.correct .option-marker {
            background-color: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }
        
        .option-item.correct .option-marker::after {
            content: 'âœ“';
            font-size: 12px;
            font-weight: bold;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--border-light);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .btn-secondary {
            padding: 8px 15px;
            background-color: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-light);
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .btn-secondary:hover {
            background-color: var(--bg-white);
        }
        
        .btn-primary {
            padding: 8px 15px;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-blue-dark);
        }

        /* Question count stat card */
        .question-count-stat {
            background-color: var(--primary-blue-lighter);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .question-count-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background-color: var(--primary-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .question-count-info {
            flex: 1;
        }

        .question-count-info h3 {
            font-size: 14px;
            margin: 0 0 5px;
            color: var(--text-muted);
        }

        .question-count-info .count {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-blue);
        }

        .question-type-card {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .question-type-item {
            flex: 1;
            min-width: 120px;
            background-color: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 15px;
            box-shadow: var(--box-shadow-sm);
            text-align: center;
        }

        .question-type-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 5px;
        }

        .question-type-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Add quiz form */
        .add-quiz-form {
            display: none;
            background-color: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow-sm);
            margin-bottom: 20px;
        }

        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-light);
        }

        .form-header h3 {
            font-size: 18px;
            color: var(--dark-blue);
            margin: 0;
        }

        .form-close {
            background: none;
            border: none;
            font-size: 18px;
            color: var(--text-muted);
            cursor: pointer;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-light);
            border-radius: 5px;
            font-size: 14px;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(11, 87, 164, 0.1);
            outline: none;
        }

        .form-check {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .form-check input {
            margin-right: 10px;
        }

        .form-text {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 5px;
        }

        .form-divider {
            margin: 20px 0;
            border-top: 1px solid var(--border-light);
        }

        .question-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-section-header h4 {
            font-size: 16px;
            color: var(--dark-blue);
            margin: 0;
        }

        .question-item-form {
            background-color: var(--bg-light);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 15px;
        }

        .option-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .option-row:last-child {
            margin-bottom: 0;
        }

        .option-input {
            flex: 1;
        }

        .option-radio {
            margin-right: 5px;
        }

        .remove-option {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            font-size: 16px;
        }

        .add-option {
            background: none;
            border: none;
            color: var(--primary-blue);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 0;
            font-size: 14px;
            font-weight: 500;
            margin-top: 10px;
        }

        .add-option i {
            font-size: 12px;
        }

        .add-question {
            background: none;
            border: 1px dashed var(--border-medium);
            color: var(--primary-blue);
            width: 100%;
            padding: 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .add-question:hover {
            background-color: var(--primary-blue-lighter);
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
        }

        .btn-cancel {
            padding: 10px 20px;
            background-color: var(--bg-light);
            color: var(--text-dark);
            border: 1px solid var(--border-light);
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-cancel:hover {
            background-color: var(--bg-white);
        }

        .btn-save {
            padding: 10px 20px;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-save:hover {
            background-color: var(--primary-blue-dark);
        }

        .remove-question {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            font-size: 16px;
            margin-left: auto;
        }
    </style>
</head>
<body class="admin-body">
        <!-- Main Content Area -->
        <main class="admin-main">
            <!-- Page Header -->
            <section class="page-header">
                <div class="header-content">
                    <div class="page-title">
                        <h1>Quizzes</h1>
                        <p>Manage all quizzes and assessments</p>
                    </div>
                </div>
            </section>

            <!-- Quiz Statistics -->
            <section class="question-stats">
                <div class="row">
                    <div class="question-count-stat">
                        <div class="question-count-icon">
                            <i class="fas fa-question"></i>
                        </div>
                        <div class="question-count-info">
                            <h3>Total Questions</h3>
                            <span class="count">842</span>
                        </div>
                    </div>
                </div>
                <div class="question-type-card">
                    <div class="question-type-item">
                        <div class="question-type-value">32</div>
                        <div class="question-type-label">Active Quizzes</div>
                    </div>
                    <div class="question-type-item">
                        <div class="question-type-value">8</div>
                        <div class="question-type-label">Weekly Quizzes</div>
                    </div>
                    <div class="question-type-item">
                        <div class="question-type-value">16</div>
                        <div class="question-type-label">Module Quizzes</div>
                    </div>
                    <div class="question-type-item">
                        <div class="question-type-value">6</div>
                        <div class="question-type-label">Final Assessments</div>
                    </div>
                </div>
            </section>

            <!-- Quiz Add Form (Hidden by default) -->
            <section class="add-quiz-form" id="add-quiz-form">
                <div class="form-header">
                    <h3>Create New Quiz</h3>
                    <button class="form-close" id="close-form"><i class="fas fa-times"></i></button>
                </div>
                <form method="POST" id="quiz-form" >
                    {% csrf_token %}
                    <div class="form-row">
                        <div class="form-group">
                            <label for="max_attempts">Maximum Attempts</label>
                            <input type="number" id="max_attempts" name="max_attempts" class="form-control" min="1" max="10" value="2">
                            <div class="form-text">Leave empty for unlimited attempts</div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="description">Quiz Description</label>
                            <textarea id="description" name="description" class="form-control" rows="3" placeholder="Brief description of the quiz content and objectives"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="instructions">Instructions for Students</label>
                        <textarea id="instructions" name="instructions" class="form-control" rows="3" placeholder="Instructions for students taking the quiz"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <div class="form-check">
                                <input type="checkbox" id="randomize_questions" name="randomize_questions">
                                <label for="randomize_questions">Randomize Question Order</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="form-check">
                                <input type="checkbox" id="show_answers" name="show_answers" checked>
                                <label for="show_answers">Show Correct Answers After Submission</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-divider"></div>
                    
                    <div class="question-section-header">
                        <h4>Quiz Questions</h4>
                    </div>
                    
                    <div id="questions-container">
                        <!-- Question 1 -->
                        <div class="question-item-form">
                            <div class="form-group">
                                <label>Question 1</label>
                                <input type="text" name="question_text_1" class="form-control" placeholder="Enter your question here" required>
                                <button type="button" class="remove-question" title="Remove Question"><i class="fas fa-trash"></i></button>
                            </div>
                            <div class="options-container">
                                <div class="option-row">
                                    <input type="radio" name="correct_option_1" value="1" class="option-radio" required>
                                    <input type="text" name="option_text_1_1" class="form-control option-input" placeholder="Option 1" required>
                                    <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                                </div>
                                <div class="option-row">
                                    <input type="radio" name="correct_option_1" value="2" class="option-radio">
                                    <input type="text" name="option_text_1_2" class="form-control option-input" placeholder="Option 2" required>
                                    <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                                </div>
                                <div class="option-row">
                                    <input type="radio" name="correct_option_1" value="3" class="option-radio">
                                    <input type="text" name="option_text_1_3" class="form-control option-input" placeholder="Option 3" required>
                                    <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                                </div>
                                <div class="option-row">
                                    <input type="radio" name="correct_option_1" value="4" class="option-radio">
                                    <input type="text" name="option_text_1_4" class="form-control option-input" placeholder="Option 4" required>
                                    <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                                </div>
                            </div>
                            <button type="button" class="add-option"><i class="fas fa-plus"></i> Add Option</button>
                        </div>
                    </div>
                    
                    <button type="button" class="add-question" id="add-question-btn">
                        <i class="fas fa-plus"></i> Add Another Question
                    </button>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" id="cancel-quiz">Cancel</button>
                        <button type="submit" class="btn-save">Create Quiz</button>
                    </div>
                </form>
            </section>

            <!-- Quizzes Table Section -->
            <section class="table-container">
                <!-- Bulk Actions Bar -->
                <div class="bulk-actions" id="bulk-actions">
                    <div class="bulk-selected">
                        <span id="selected-count">0</span> quizzes selected
                    </div>
                    <div class="bulk-buttons">
                        <button class="bulk-btn assign"><i class="fas fa-user-tag"></i> Assign to Batch</button>
                        <button class="bulk-btn delete"><i class="fas fa-trash-alt"></i> Delete</button>
                    </div>
                </div>
                
                <!-- Table Header with Search and Actions -->
                <div class="table-header">
                    <h2 class="table-title">All Quizzes</h2>
                    <div class="table-actions">
                        <div class="search-container">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" class="search-input" placeholder="Search quizzes...">
                        </div>
                        <div class="filter-container">
                            <button class="filter-btn" id="filter-btn">
                                <i class="fas fa-filter"></i>
                                <span>Filter</span>
                            </button>
                            <div class="filter-dropdown" id="filter-dropdown">
                                <div class="filter-group">
                                    <label class="filter-label">Program</label>
                                    <select class="filter-select">
                                        <option value="">All Programs</option>
                                        <option value="ctp">Complete Trading Program (CTP)</option>
                                        <option value="amp">Arthavidya Mentorship Program (AMP)</option>
                                        <option value="gmp">Growth Mindset Program (GMP)</option>
                                        <option value="sip">Smart Income Program (SIP)</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label class="filter-label">Quiz Type</label>
                                    <select class="filter-select">
                                        <option value="">All Types</option>
                                        <option value="weekly">Weekly Quiz</option>
                                        <option value="module">Module Quiz</option>
                                        <option value="assessment">Assessment Quiz</option>
                                        <option value="final">Final Assessment</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label class="filter-label">Status</label>
                                    <select class="filter-select">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="draft">Draft</option>
                                        <option value="archived">Archived</option>
                                    </select>
                                </div>
                                <div class="filter-actions">
                                    <button class="btn-reset">Reset</button>
                                    <button class="btn-apply">Apply Filters</button>
                                </div>
                            </div>
                        </div>
                        <button id="add-quiz-btn" class="btn-add">
                            <i class="fas fa-plus"></i>
                            <span>Add Quiz</span>
                        </button>
                    </div>
                </div>
                
                <!-- Quizzes Table -->
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th class="checkbox-cell">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" id="select-all">
                                        <span class="checkmark"></span>
                                    </label>
                                </th>
                                <th>Quiz Title</th>
                                <th>Program & Batch</th>
                                <th>Type</th>
                                <th>Questions</th>
                                <th>Difficulty</th>
                                <th>Completion</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="checkbox-cell">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" class="row-checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td>
                                    <div>
                                        <strong>Module 3: Price Action Basics</strong>
                                        <p>Created on Apr 02, 2025</p>
                                    </div>
                                </td>
                                <td>
                                    <div>
                                        <strong>Complete Trading Program (CTP)</strong>
                                        <p>April 2025 Batch</p>
                                    </div>
                                </td>
                                <td><span class="quiz-type-badge quiz-type-module">Module Quiz</span></td>
                                <td>15 Questions</td>
                                <td>
                                    <div class="difficulty-level difficulty-medium">
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                    </div>
                                </td>
                                <td>
                                    <div class="progress-container">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 78%"></div>
                                        </div>
                                        <span class="progress-text">78%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge status-success">Active</span></td>
                                <td>
                                    <div class="row-actions">
                                        <button class="action-btn view preview-quiz" title="Preview" data-id="1">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn delete" title="Delete">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-cell">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" class="row-checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td>
                                    <div>
                                        <strong>Weekly Quiz: Candlestick Patterns</strong>
                                        <p>Created on Apr 05, 2025</p>
                                    </div>
                                </td>
                                <td>
                                    <div>
                                        <strong>Complete Trading Program (CTP)</strong>
                                        <p>March 2025 Batch</p>
                                    </div>
                                </td>
                                <td><span class="quiz-type-badge quiz-type-weekly">Weekly Quiz</span></td>
                                <td>10 Questions</td>
                                <td>
                                    <div class="difficulty-level difficulty-easy">
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                    </div>
                                </td>
                                <td>
                                    <div class="progress-container">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 92%"></div>
                                        </div>
                                        <span class="progress-text">92%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge status-success">Active</span></td>
                                <td>
                                    <div class="row-actions">
                                        <button class="action-btn view preview-quiz" title="Preview" data-id="2">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn delete" title="Delete">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-cell">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" class="row-checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td>
                                    <div>
                                        <strong>Final Assessment: Trading Psychology</strong>
                                        <p>Created on Mar 25, 2025</p>
                                    </div>
                                </td>
                                <td>
                                    <div>
                                        <strong>Growth Mindset Program (GMP)</strong>
                                        <p>All Batches</p>
                                    </div>
                                </td>
                                <td><span class="quiz-type-badge quiz-type-final">Final Assessment</span></td>
                                <td>25 Questions</td>
                                <td>
                                    <div class="difficulty-level difficulty-hard">
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                    </div>
                                </td>
                                <td>
                                    <div class="progress-container">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 65%"></div>
                                        </div>
                                        <span class="progress-text">65%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge status-success">Active</span></td>
                                <td>
                                    <div class="row-actions">
                                        <button class="action-btn view preview-quiz" title="Preview" data-id="3">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn delete" title="Delete">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-cell">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" class="row-checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td>
                                    <div>
                                        <strong>Module 2: Investment Strategies</strong>
                                        <p>Created on Apr 01, 2025</p>
                                    </div>
                                </td>
                                <td>
                                    <div>
                                        <strong>Smart Income Program (SIP)</strong>
                                        <p>February 2025 Batch</p>
                                    </div>
                                </td>
                                <td><span class="quiz-type-badge quiz-type-module">Module Quiz</span></td>
                                <td>12 Questions</td>
                                <td>
                                    <div class="difficulty-level difficulty-medium">
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                    </div>
                                </td>
                                <td>
                                    <div class="progress-container">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 85%"></div>
                                        </div>
                                        <span class="progress-text">85%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge status-success">Active</span></td>
                                <td>
                                    <div class="row-actions">
                                        <button class="action-btn view preview-quiz" title="Preview" data-id="4">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn delete" title="Delete">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-cell">
                                    <label class="custom-checkbox">
                                        <input type="checkbox" class="row-checkbox">
                                        <span class="checkmark"></span>
                                    </label>
                                </td>
                                <td>
                                    <div>
                                        <strong>Assessment: Risk Management</strong>
                                        <p>Created on Mar 18, 2025</p>
                                    </div>
                                </td>
                                <td>
                                    <div>
                                        <strong>Arthavidya Mentorship Program (AMP)</strong>
                                        <p>April 2025 Batch</p>
                                    </div>
                                </td>
                                <td><span class="quiz-type-badge quiz-type-assessment">Assessment Quiz</span></td>
                                <td>20 Questions</td>
                                <td>
                                    <div class="difficulty-level difficulty-hard">
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                        <span class="difficulty-dot"></span>
                                    </div>
                                </td>
                                <td>
                                    <div class="progress-container">
                                        <div class="progress-bar">
                                            <div class="progress-fill" style="width: 38%"></div>
                                        </div>
                                        <span class="progress-text">38%</span>
                                    </div>
                                </td>
                                <td><span class="status-badge status-success">Active</span></td>
                                <td>
                                    <div class="row-actions">
                                        <button class="action-btn view preview-quiz" title="Preview" data-id="5">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn delete" title="Delete">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Table Footer with Pagination -->
                <div class="table-footer">
                    <div class="page-info">
                        Showing 1 to 5 of 32 entries
                    </div>
                    <div class="pagination">
                        <button class="page-btn disabled">
                            <i class="fas fa-angle-double-left"></i>
                        </button>
                        <button class="page-btn disabled">
                            <i class="fas fa-angle-left"></i>
                        </button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn">4</button>
                        <button class="page-btn">5</button>
                        <button class="page-btn">
                            <i class="fas fa-angle-right"></i>
                        </button>
                        <button class="page-btn">
                            <i class="fas fa-angle-double-right"></i>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Quiz Preview Modal -->
    <div class="quiz-preview-modal" id="quiz-preview-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Quiz Preview: <span id="preview-quiz-title">Module 3: Price Action Basics</span></h2>
                <button class="modal-close" id="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="quiz-info">
                    <div class="quiz-info-item">
                        <div class="quiz-info-label">Program:</div>
                        <div class="quiz-info-value" id="preview-program">Complete Trading Program (CTP)</div>
                    </div>
                    <div class="quiz-info-item">
                        <div class="quiz-info-label">Quiz Type:</div>
                        <div class="quiz-info-value" id="preview-type">Module Quiz</div>
                    </div>
                    <div class="quiz-info-item">
                        <div class="quiz-info-label">Difficulty:</div>
                        <div class="quiz-info-value" id="preview-difficulty">Medium</div>
                    </div>
                    <div class="quiz-info-item">
                        <div class="quiz-info-label">Time Limit:</div>
                        <div class="quiz-info-value" id="preview-time-limit">30 minutes</div>
                    </div>
                    <div class="quiz-info-item">
                        <div class="quiz-info-label">Passing Score:</div>
                        <div class="quiz-info-value" id="preview-passing-score">70%</div>
                    </div>
                    <div class="quiz-info-item">
                        <div class="quiz-info-label">Description:</div>
                        <div class="quiz-info-value" id="preview-description">This quiz covers the fundamentals of price action trading, including candlestick patterns, support and resistance levels, and trend analysis.</div>
                    </div>
                </div>
                
                <div class="question-list">
                    <div class="question-item">
                        <div class="question-text">Which of the following candlestick patterns is a reversal pattern?</div>
                        <ul class="options-list">
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Doji</div>
                            </li>
                            <li class="option-item correct">
                                <div class="option-marker"></div>
                                <div class="option-text">Engulfing Pattern</div>
                            </li>
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Three White Soldiers</div>
                            </li>
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Marubozu</div>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="question-item">
                        <div class="question-text">Which timeframe is NOT commonly used for price action analysis?</div>
                        <ul class="options-list">
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Daily</div>
                            </li>
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">4-Hour</div>
                            </li>
                            <li class="option-item correct">
                                <div class="option-marker"></div>
                                <div class="option-text">7-Minute</div>
                            </li>
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Weekly</div>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="question-item">
                        <div class="question-text">What is the primary focus of price action trading?</div>
                        <ul class="options-list">
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Using technical indicators</div>
                            </li>
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Analyzing company fundamentals</div>
                            </li>
                            <li class="option-item correct">
                                <div class="option-marker"></div>
                                <div class="option-text">Analyzing price movements on a chart</div>
                            </li>
                            <li class="option-item">
                                <div class="option-marker"></div>
                                <div class="option-text">Following news events</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="modal-close-btn">Close</button>
                <button class="btn-primary">Edit Quiz</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{% static 'js/admin.js' %}"></script>  
    <script src="{% static 'js/admin-main.js'%}"></script>
    <script src="{% static 'js/admin-sidebar.js'%}"></script>
    <script>
        // Initialize submenu toggles
        document.addEventListener('DOMContentLoaded', function() {
            // Toggle submenu on click
            const submenuToggles = document.querySelectorAll('.submenu-toggle');
            
            submenuToggles.forEach(toggle => {
                // Get parent li and submenu elements
                const parentLi = toggle.parentElement;
                const submenu = toggle.nextElementSibling;
                
                // Set initial state for active submenus
                if (parentLi.classList.contains('active')) {
                    submenu.style.display = 'block';
                } else {
                    submenu.style.display = 'none';
                }
                
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Toggle active class on parent li
                    parentLi.classList.toggle('active');
                    
                    // Toggle submenu visibility with animation
                    if (submenu.style.display === 'none' || submenu.style.display === '') {
                        submenu.style.display = 'block';
                        submenu.style.maxHeight = submenu.scrollHeight + 'px';
                        
                        // Rotate indicator
                        this.querySelector('.submenu-indicator').style.transform = 'translateY(-50%) rotate(90deg)';
                    } else {
                        submenu.style.display = 'none';
                        submenu.style.maxHeight = '0';
                        
                        // Reset indicator
                        this.querySelector('.submenu-indicator').style.transform = 'translateY(-50%)';
                    }
                });
            });
            
            // Automatically expand submenus for active menu items
            const activeSubmenuItems = document.querySelectorAll('.submenu li.active');
            activeSubmenuItems.forEach(item => {
                const parentLi = item.parentElement.parentElement;
                const submenu = item.parentElement;
                
                // Add active class to parent and show submenu
                parentLi.classList.add('active');
                submenu.style.display = 'block';
                
                // Rotate indicator
                const indicator = parentLi.querySelector('.submenu-indicator');
                if (indicator) {
                    indicator.style.transform = 'translateY(-50%) rotate(90deg)';
                }
            });
        });

        // Filter dropdown toggle
        const filterBtn = document.getElementById('filter-btn');
        const filterDropdown = document.getElementById('filter-dropdown');
        
        filterBtn.addEventListener('click', function() {
            filterDropdown.classList.toggle('show');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            if (!filterBtn.contains(event.target) && !filterDropdown.contains(event.target)) {
                filterDropdown.classList.remove('show');
            }
        });
        
        // Select all checkbox functionality
        const selectAllCheckbox = document.getElementById('select-all');
        const rowCheckboxes = document.querySelectorAll('.row-checkbox');
        const bulkActions = document.getElementById('bulk-actions');
        const selectedCount = document.getElementById('selected-count');
        
        selectAllCheckbox.addEventListener('change', function() {
            rowCheckboxes.forEach(checkbox => {
                checkbox.checked = this.checked;
            });
            
            updateBulkActions();
        });
        
        rowCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                updateBulkActions();
                
                // Update select all checkbox
                if (!this.checked) {
                    selectAllCheckbox.checked = false;
                } else {
                    const allChecked = Array.from(rowCheckboxes).every(c => c.checked);
                    selectAllCheckbox.checked = allChecked;
                }
            });
        });
        
        function updateBulkActions() {
            const checkedCount = document.querySelectorAll('.row-checkbox:checked').length;
            
            if (checkedCount > 0) {
                bulkActions.classList.add('show');
                selectedCount.textContent = checkedCount;
            } else {
                bulkActions.classList.remove('show');
            }
        }
        
        // Quiz Preview Modal
        const previewButtons = document.querySelectorAll('.preview-quiz');
        const previewModal = document.getElementById('quiz-preview-modal');
        const closeModalBtn = document.getElementById('close-modal');
        const modalCloseBtnFooter = document.getElementById('modal-close-btn');
        
        previewButtons.forEach(button => {
            button.addEventListener('click', function() {
                const quizId = this.getAttribute('data-id');
                // In a real application, you would fetch quiz data from backend
                // For demo purposes, we're just showing the modal
                previewModal.style.display = 'flex';
            });
        });
        
        closeModalBtn.addEventListener('click', function() {
            previewModal.style.display = 'none';
        });
        
        modalCloseBtnFooter.addEventListener('click', function() {
            previewModal.style.display = 'none';
        });
        
        // Close modal when clicking outside
        previewModal.addEventListener('click', function(event) {
            if (event.target === previewModal) {
                previewModal.style.display = 'none';
            }
        });
        
        // Add Quiz Form Toggle
        const addQuizBtn = document.getElementById('add-quiz-btn');
        const addQuizForm = document.getElementById('add-quiz-form');
        const closeFormBtn = document.getElementById('close-form');
        const cancelQuizBtn = document.getElementById('cancel-quiz');
        
        addQuizBtn.addEventListener('click', function() {
            addQuizForm.style.display = 'block';
        });
        
        closeFormBtn.addEventListener('click', function() {
            addQuizForm.style.display = 'none';
        });
        
        cancelQuizBtn.addEventListener('click', function() {
            addQuizForm.style.display = 'none';
        });
        
        // Add Question Button
        const addQuestionBtn = document.getElementById('add-question-btn');
        const questionsContainer = document.getElementById('questions-container');
        let questionCount = 1;
        
        addQuestionBtn.addEventListener('click', function() {
            questionCount++;
            
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-item-form';
            
            // Create the HTML content for the new question
            questionDiv.innerHTML = `
                <div class="form-group">
                    <label>Question ${questionCount}</label>
                    <input type="text" name="question_text_${questionCount}" class="form-control" placeholder="Enter your question here" required>
                    <button type="button" class="remove-question" title="Remove Question"><i class="fas fa-trash"></i></button>
                </div>
                <div class="options-container">
                    <div class="option-row">
                        <input type="radio" name="correct_option_${questionCount}" value="1" class="option-radio" required>
                        <input type="text" name="option_text_${questionCount}_1" class="form-control option-input" placeholder="Option 1" required>
                        <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="option-row">
                        <input type="radio" name="correct_option_${questionCount}" value="2" class="option-radio">
                        <input type="text" name="option_text_${questionCount}_2" class="form-control option-input" placeholder="Option 2" required>
                        <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="option-row">
                        <input type="radio" name="correct_option_${questionCount}" value="3" class="option-radio">
                        <input type="text" name="option_text_${questionCount}_3" class="form-control option-input" placeholder="Option 3" required>
                        <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="option-row">
                        <input type="radio" name="correct_option_${questionCount}" value="4" class="option-radio">
                        <input type="text" name="option_text_${questionCount}_4" class="form-control option-input" placeholder="Option 4" required>
                        <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <button type="button" class="add-option"><i class="fas fa-plus"></i> Add Option</button>
            `;
            
            questionsContainer.appendChild(questionDiv);
            
            // Add event listeners to the new question's buttons
            const newRemoveQuestion = questionDiv.querySelector('.remove-question');
            const newRemoveOptions = questionDiv.querySelectorAll('.remove-option');
            const newAddOption = questionDiv.querySelector('.add-option');
            
            newRemoveQuestion.addEventListener('click', function() {
                questionDiv.remove();
            });
            
            newRemoveOptions.forEach(button => {
                button.addEventListener('click', removeOption);
            });
            
            newAddOption.addEventListener('click', function() {
                addOption(this.parentElement.querySelector('.options-container'), questionCount);
            });
        });
        
        // Remove Question Button
        document.addEventListener('click', function(e) {
            if (e.target.closest('.remove-question')) {
                const questionItem = e.target.closest('.question-item-form');
                questionItem.remove();
            }
        });
        
        // Add Option Button
        document.addEventListener('click', function(e) {
            if (e.target.closest('.add-option')) {
                const button = e.target.closest('.add-option');
                const optionsContainer = button.previousElementSibling;
                const questionItem = button.closest('.question-item-form');
                const questionIndex = Array.from(questionsContainer.children).indexOf(questionItem) + 1;
                
                addOption(optionsContainer, questionIndex);
            }
        });
        
        function addOption(container, questionIndex) {
            const optionRows = container.querySelectorAll('.option-row');
            const optionCount = optionRows.length + 1;
            
            const optionRow = document.createElement('div');
            optionRow.className = 'option-row';
            
            optionRow.innerHTML = `
                <input type="radio" name="correct_option_${questionIndex}" value="${optionCount}" class="option-radio">
                <input type="text" name="option_text_${questionIndex}_${optionCount}" class="form-control option-input" placeholder="Option ${optionCount}" required>
                <button type="button" class="remove-option" title="Remove Option"><i class="fas fa-times"></i></button>
            `;
            
            container.appendChild(optionRow);
            
            // Add event listener to the new remove button
            const removeButton = optionRow.querySelector('.remove-option');
            removeButton.addEventListener('click', removeOption);
        }
        
        function removeOption(e) {
            if (!e.target) {
                e = window.event;
                e.target = e.srcElement;
            }
            
            const optionRow = this.closest('.option-row');
            const optionsContainer = optionRow.parentElement;
            
            // Only remove if there are more than 2 options
            if (optionsContainer.querySelectorAll('.option-row').length > 2) {
                optionRow.remove();
                
                // Renumber the remaining options
                const optionRows = optionsContainer.querySelectorAll('.option-row');
                optionRows.forEach((row, index) => {
                    const radio = row.querySelector('.option-radio');
                    radio.value = index + 1;
                });
            } else {
                alert('A question must have at least 2 options.');
            }
        }
        
        // Initialize remove option buttons
        const removeOptionButtons = document.querySelectorAll('.remove-option');
        removeOptionButtons.forEach(button => {
            button.addEventListener('click', removeOption);
        });
        
        // Form submission
        const quizForm = document.getElementById('quiz-form');
        
        quizForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // In a real application, you would submit the form data to the server
            // For demo purposes, we'll just show an alert
            alert('Quiz created successfully!');
            
            // Reset form and hide it
            quizForm.reset();
            addQuizForm.style.display = 'none';
        });
    </script>
{% endblock %}